<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <title>Table</title>
    <link rel="stylesheet" href="css/app.css">
    <script language="JavaScript">
        function unAuthorize() {
            localStorage.clear();
            window.location.href = "./index.html";
        }

        function getOperations() {
            fetch("http://localhost:8080/operations/all")
                .then( (response) => {
                    if(response.status >= 400){
                        console.log("Error occured");
                        alert("You have no access. Log in please.")
                        localStorage.clear();
                        return Promise.reject();
                    }
                    return response.json();
                }).then(function (operationsList) {

                var htmlOperations = "";

                htmlOperations += "<table id='operations' border = '1' align='center'>";
                htmlOperations += "<tr align='center'>";
                htmlOperations += "<th>id</th>";
                htmlOperations += "<th width=100px><a href=\"table-articles.html\">article_id</a></th>";
                htmlOperations += "<th width=70px>debit</th>";
                htmlOperations += "<th width=70px>credit</th>";
                htmlOperations += "<th width=100px>create_date</th>";
                htmlOperations += "<th width=100px><a href=\"table-balance.html\">balance_id</a></th>";
                htmlOperations += "<th></br></th>"
                htmlOperations += "<th></br></th>"
                htmlOperations += "</tr>";

                for(var i = 0; i < operationsList.length; i++){
                    htmlOperations += "<tr align='center'>";
                    htmlOperations += "<td>" + operationsList[i].id + "</td>";
                    htmlOperations += "<td>" + operationsList[i].article.id + "</td>";
                    htmlOperations += "<td>" + operationsList[i].debit + "</td>";
                    htmlOperations += "<td>" + operationsList[i].credit + "</td>";
                    htmlOperations += "<td>" + operationsList[i].createDate + "</td>";
                    htmlOperations += "<td>" + operationsList[i].balance.id + "</td>";
                    htmlOperations += "<td id='tb+${articlesList[i].id}'><a href=# onclick='deleteArticle(this.id)'>delete</a></td>";
                    htmlOperations += "<td><a href=# onclick='editArticle(1)'>edit</a></td>";
                    htmlOperations +="</tr>";
                }

                htmlOperations += "<tr>";
                htmlOperations += "<td><a href=#>+</a></td>";
                htmlOperations += "<td></br></td>";
                htmlOperations += "<td></br></td>";
                htmlOperations += "<td></br></td>";
                htmlOperations += "<td></br></td>";
                htmlOperations += "<td></br></td>";
                htmlOperations += "<td></br></td>";
                htmlOperations += "<td></br></td>";
                htmlOperations += "</tr>";

                document.getElementById("wrapper").innerHTML += htmlOperations;
                });
        }
    </script>
</head>
<body>
<main id="app">
    <header>
        <h1>Operations Table</h1>
    </header>
    <p></p>
    <div id="wrapper"><script>getOperations();</script></div>
<!--    <table border = "1" align="center">-->
<!--        <tr>-->
<!--            <th>id</th>-->
<!--            <th><a href="table-articles.html">article_id</a></th>-->
<!--            <th>debit</th>-->
<!--            <th>credit</th>-->
<!--            <th>credit_date</th>-->
<!--            <th><a href="table-balance.html">balance_id</a></th>-->
<!--        </tr>-->
<!--        <tr>-->
<!--            <td><br></td>-->
<!--            <td><br></td>-->
<!--            <td><br></td>-->
<!--            <td><br></td>-->
<!--            <td><br></td>-->
<!--            <td><br></td>-->
<!--        </tr>-->
<!--    </table>-->
    <p align="center">
        <select>
            <option>Search by id</option>
            <option>Search by name</option>
        </select>
        <input class="textfield" type="text">
        <input value="Search" type="button" onclick="location.href='success.html'"/>
    </p>
    <form id="todo-form">
        <input value="Back" type="button" onclick="history.back();"/>
        <input value="Info" type="button" onclick="location.href='index.html'"/>
        <input value="Log Out" type="button" onclick=unAuthorize() />
    </form>
</main>
</body>
</html>